class Solution {
public:
    int kthSmallest(vector<vector<int>>& a, int k) {
        int n = a.size();
        int low = a[0][0], high = a[n-1][n-1];
        while(low<high){
            int mid = (low+high)>>1;
            int j = n-1;
            int cnt = 0;
            for(int i = 0;i<n;i++){
                while(j>=0 && a[i][j]>mid) j--;
                cnt+= (j+1);
            }
            if(cnt<k) low = mid+1;
            else high = mid;
        }
        return low;
    }
};
